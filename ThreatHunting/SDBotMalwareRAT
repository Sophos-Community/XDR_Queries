##### SOPHOS COMMUNITY POST #####

https://community.sophos.com/intercept-x-endpoint/i/threat-hunting/live-discover-query---sdbot-malware---rat

############ 

SELECT DISTINCT
srj.time AS event_timestamp,
srj.keyName,
srj.value,
srj.eventType,
srj.sophosPID,
srj.valueName,
'REG_BINARY' AS valueType,
'SDBbot Remote Access Trojan stores the RAT component in the registry and establishes persistence for the loader component.' AS description
FROM sophos_registry_journal AS srj
WHERE srj.keyName LIKE "\REGISTRY\MACHINE\SOFTWARE\Microsoft\___"
AND srj.time > STRFTIME("%s", "NOW") - 925
AND lower(srj.valueName) = srj.valueName
AND LENGTH(srj.valueName) = 1
-- valueType=3 is Binary
AND srj.valueType = 3
-- eventType=5 is valueSet
AND srj.eventType = 5;
